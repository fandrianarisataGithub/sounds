{% extends "base.html.twig" %}
{% block title %}
	Donnée mensuelle
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/dashboard.css')}}">
{% endblock %}
{% block body %}
    
    <section
        id="contents" class="container-fluid">
        <!-- entete content -->
        {% include "nav2.html.twig" %}
        <!-- / entete content -->
        <div id="hrs_content" class="data_mensuel">
           {{ form_start(form) }}
                <div class="col-lg-12 col-md-12 col-sm-12 col-sm-12 col-xs-12">
                    <section class="section_part" id="section_part_top">
                        <div class="sous_titre">
                            <h2>Donnée mensuelle</h2>
                            <div class="block_month">
                                <select name="donnee_mensuelle_mois" id="donnee_mensuelle_mois">
                                    <option value="01">JANVIER</option>
                                    <option value="02">FEVRIER</option>
                                    <option value="03">MARS</option>
                                    <option value="04">AVRIL</option>
                                    <option value="05">MAI</option>
                                    <option value="06">JUIN</option>
                                    <option value="07">JUILLET</option>
                                    <option value="08">AOUT</option>
                                    <option value="09">SEPTEMBRE</option>
                                    <option value="10">OCTOBRE</option>
                                    <option value="11">NOVEMBRE</option>
                                    <option value="12">DECEMBRE</option>
                                </select>
                                <select name="donnee_mensuelle_annee" id="donnee_mensuelle_annee">
                                    <option value="2020">2020</option>
                                </select>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-sm-12 col-xs-12">
                    <div class="tab_content" id="data_days">
                        <div class="h4_titre">
                            <h4>Stock</h4>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="c_a">Valeur de stock :
                                </label>
                                {# <input type="text" maxlength="23" class="input_nombre" id="stock_value"> #}
                                {{ form_widget(form.stock, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                        </div>
                        <div class="h4_titre">
                            <h4>Cost</h4>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Restaurant :
                                </label>
                                {# <input type="text" max="100" maxlength="18" class="input_nombre" id="restaurant_value"> #}
                                {{ form_widget(form.cost_restaurant_value, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                            <div class="form-group">
                                    <label for=""> Taux : 
                                    </label>
                                     {{ form_widget(form.cost_restaurant_pourcent, {
                                        'attr' : {
                                            'class' : 'input_pourcent',
                                           
                                            'max' : '100',
                                        }
                                    }) }}
                                    {# <input type="text" class="input_pourcent" max="100"> #}
                                    <span class="span__pourcent">%</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Electricité :
                                </label>
                                {# <input type="text" max="100" maxlength="18" class="input_nombre" id="electricite_value"> #}
                                {{ form_widget(form.cost_electricite_value, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                            <div class="form-group">
                                    <label for=""> Taux : 
                                    </label>
                                     {{ form_widget(form.cost_electricite_pourcent, {
                                        'attr' : {
                                            'class' : 'input_pourcent',
                                           
                                            'max' : '100',
                                        }
                                    }) }}
                                    {# <input type="text" class="input_pourcent" max="100"> #}
                                    <span class="span__pourcent">%</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Eau :
                                </label>
                                {# <input type="text" max="100" maxlength="18" class="input_nombre" id="eau_value"> #}
                                {{ form_widget(form.cost_eau_value, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                            <div class="form-group">
                                    <label for=""> Taux : 
                                    </label>
                                     {{ form_widget(form.cost_eau_pourcent, {
                                        'attr' : {
                                            'class' : 'input_pourcent',
                                           
                                            'max' : '100',
                                        }
                                    }) }}
                                    {# <input type="text" class="input_pourcent" max="100"> #}
                                    <span class="span__pourcent">%</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Gasoil :
                                </label>
                                {# <input type="text" max="100" maxlength="18" class="input_nombre" id="gasoil_value"> #}
                                {{ form_widget(form.cost_gasoil_value, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                            <div class="form-group">
                                    <label for=""> Taux : 
                                    </label>
                                     {{ form_widget(form.cost_gasoil_pourcent, {
                                        'attr' : {
                                            'class' : 'input_pourcent',
                                           
                                            'max' : '100',
                                        }
                                    }) }}
                                    {# <input type="text" class="input_pourcent" max="100"> #}
                                    <span class="span__pourcent">%</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Salaire brut :
                                </label>
                                {# <input type="text" max="100" maxlength="18" class="input_nombre" id="salaire_brute_value"> #}
                                {{ form_widget(form.salaire_brute_value, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar">Ar</span>
                            </div>
                            <div class="form-group">
                                    <label for=""> Taux : 
                                    </label>
                                     {{ form_widget(form.salaire_brute_pourcent, {
                                        'attr' : {
                                            'class' : 'input_pourcent',
                                           
                                            'max' : '100',
                                        }
                                    }) }}
                                    {# <input type="text" class="input_pourcent" max="100"> #}
                                    <span class="span__pourcent">%</span>
                            </div>
                        </div>
                        <div class="h4_titre">
                            <h4>Service - Quality - Notation</h4>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Interne :
                                </label>
                                 {# <input type="text" class="input_pourcent" max="100"> #}
                                {{ form_widget(form.sqn_interne, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar"> / 10</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Booking :
                                </label>
                                 {# <input type="text" class="input_pourcent" max="100"> #}
                                {{ form_widget(form.sqn_booking, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar"> / 10</span>
                            </div>
                        </div>
                        <div class="data_form">
                            <div class="form-group">
                                <label for="n_couvert">Tripadvisor :
                                </label>
                                 {# <input type="text" class="input_pourcent" max="100"> #}
                                {{ form_widget(form.sqn_tripadvisor, {
                                                                'attr' : {
                                                                    'class' : 'input_nombre',
                                                                    
                                                                    'maxlength' : '23',
                                                                    'max' : '100',
                                                                }
                                                            }) }}
                                <span class="span__ar"> / 5</span>
                            </div>
                        </div>
                        <div class="btn-list">
                            <ul>
                                <li><button type="submit" id = "btn_add_donnee_mensuelle" class="btn btn-warning"><span>Enregistrer</span></button></li>
                            </ul>
                        </div>
                    </div>
                </div>

            {{ form_end(form) }}
        </div>

    </section>


{% endblock %}

{% block javascripts %}
<!-- un plugin tres important pour les input -->

<script src="{{ asset('js/cleave.min.js') }}"></script>


<script>

    document.querySelector(".input_pourcent").onkeyup = function(){
        handleChange(this);
       // alert('kjh')
    }

	function handleChange(input) {

        if (input.value < 0) {
        input.value = 0;
        } else if (input.value > 100) {
        input.value = 100;
        } else if (isNaN(input.value)) {
        input.value = 0;
        }

    }
</script>

<!-- limiter les  -->

<script>

	/* utilisation de cleave.js pour les input */

    // style des % et Ar
    var n = document.querySelectorAll(".input_nombre");
    for (var i = n.length - 1; i >= 0; i--) {
    new Cleave(n[i], { // prefix: 'Ar ',
    numeral: true,
    delimiter: [' '],
    numeralThousandsGroupStyle: 'thousand',
    numericOnly: true
    });
    }


new Cleave('.input_pourcent', {blocks: [4]});


/* fin utilisation de cleave.js pour les input */

</script>
<script>

	$(document).ready(function () {
        var pseudo_hotel = '{{ hotel }}';
        //$('form[name=donnee_mensuelle]').submit();
        $('#btn_add_donnee_mensuelle').on("click", function(ev){
            ev.preventDefault();
                var m = $('#donnee_mensuelle_mois').val();
                var a = $('#donnee_mensuelle_annee').val();
                var mois = m+"-"+a;
                // alert(mois);
                $.ajax({
                    url : "/profile/tester_mois_dm/" + pseudo_hotel,
                    type : "POST",
                    data : {
                        'mois' : mois,
                    },
                    success : function(response){
                        if(response == "non vide"){
                            var choice = confirm("Ce mois admet déja un enregistrement.\nVoulez-vous emporter ce changement?");
                            if(choice == true){
                               $('form[name=donnee_mensuelle]').submit();
                            }
                        }
                        else{
                            $('form[name=donnee_mensuelle]').submit();
                        }
                    },
                    error : function(){
                        alert('erreur de ajax tester_mois_dm');
                    }
                })
        })
    });
</script>



{% endblock %}